# Инструкция по настройке Telegram бота для записи на грузоперевозки

## Возможности бота

- Автоматический прием заявок от клиентов
- Пошаговый диалог для сбора информации о перевозке
- Сохранение заявок в JSON-файл для удобного доступа
- Отправка уведомлений о новых заявках владельцу
- Предоставление информации о вашем сервисе грузоперевозок

## Подготовка к установке

### Предварительные требования

- Python 3.7 или выше
- Доступ к интернету
- Хостинг для запуска бота (VPS, PythonAnywhere, Heroku и т.д.)

### Создание бота в Telegram

1. Откройте Telegram и найдите бота [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота:
   - Укажите имя бота (отображаемое имя)
   - Укажите username бота (должен заканчиваться на "bot")
4. После создания вы получите токен бота - **сохраните его**, он понадобится для настройки

### Получение вашего Telegram ID

1. Найдите бота [@userinfobot](https://t.me/userinfobot) в Telegram
2. Начните диалог с ним, отправив любое сообщение
3. Бот ответит вашим Telegram ID - **сохраните его**, он понадобится для получения уведомлений

## Установка бота

### Шаг 1: Подготовка окружения

1. Установите Python, если он еще не установлен
2. Создайте новую директорию для бота
3. В этой директории установите необходимые библиотеки:

```bash
pip install python-telegram-bot==13.7
```

### Шаг 2: Настройка скрипта

1. Скопируйте файл `telegram_bot.py` в созданную директорию
2. Откройте файл `telegram_bot.py` в любом текстовом редакторе
3. Найдите строку `updater = Updater("YOUR_TOKEN_HERE")` и замените `YOUR_TOKEN_HERE` на токен вашего бота
4. Найдите закомментированную строку `# context.bot.send_message(chat_id=ADMIN_ID, text=admin_notification, parse_mode='Markdown')`
5. Раскомментируйте эту строку и замените `ADMIN_ID` на ваш Telegram ID (числовое значение)

### Шаг 3: Запуск бота

#### Локальный запуск (для тестирования)

```bash
python telegram_bot.py
```

#### Запуск на сервере (для постоянной работы)

##### На Linux/VPS:

1. Установите tmux для запуска процесса в фоновом режиме:
```bash
sudo apt-get install tmux
```

2. Создайте новую сессию tmux:
```bash
tmux new -s telegram_bot
```

3. Запустите бота:
```bash
python3 telegram_bot.py
```

4. Отключитесь от сессии (бот продолжит работать в фоне):
- Нажмите Ctrl+B, затем D

5. Чтобы вернуться к сессии позже:
```bash
tmux attach -t telegram_bot
```

##### На PythonAnywhere:

1. Загрузите `telegram_bot.py` через интерфейс Files
2. Создайте новую задачу в разделе Tasks с командой:
```bash
python3 /home/YourUsername/telegram_bot.py
```

## Структура заявок

Заявки сохраняются в файл `orders.json` в следующем формате:

```json
[
  {
    "name": "Имя клиента",
    "phone": "Номер телефона",
    "route": "Челябинск → Магнитогорск",
    "cargo_desc": "Описание груза",
    "weight": 500,
    "timestamp": "2023-10-28 15:30:45"
  },
  // Другие заявки...
]
```

## Обслуживание бота

### Проверка заявок

Заявки сохраняются в файле `orders.json` в директории с ботом. Вы можете:
- Открыть файл любым текстовым редактором для просмотра заявок
- Создать резервные копии файла при необходимости
- Очистить файл (сохранив структуру `[]`), если заявки больше не нужны

### Обновление информации о перевозках

Если вам нужно обновить информацию о перевозках:

1. Откройте файл `telegram_bot.py`
2. Найдите функцию `help_command`
3. Измените текст сообщения с информацией
4. Сохраните файл и перезапустите бота

## Решение проблем

### Бот не отвечает

1. Проверьте, запущен ли скрипт бота
2. Проверьте правильность токена
3. Проверьте интернет-соединение на сервере

### Заявки не сохраняются

1. Проверьте права на запись в директории с ботом
2. Убедитесь, что файл `orders.json` существует и содержит как минимум `[]`

### Не приходят уведомления

1. Проверьте правильность указанного Telegram ID
2. Убедитесь, что вы начали диалог с ботом хотя бы один раз

## Расширение функциональности

При желании вы можете доработать бота:

- Добавить выбор даты и времени для перевозки
- Интегрировать расчет стоимости
- Добавить фотографии груза
- Создать админ-панель для управления заявками

## Контакты для поддержки

Если у вас возникли сложности с настройкой бота, вы можете обратиться за помощью. 